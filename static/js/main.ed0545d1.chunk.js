(this.webpackJsonpdemo=this.webpackJsonpdemo||[]).push([[0],{35:function(e,t,a){},36:function(e,t,a){},47:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),c=a(12),l=a.n(c),i=(a(34),a(35),a(36),a(3)),o=a(7),r=a(13),d={isLoggedIn:!1,isAdmin:!1,email:null,token:null};localStorage.token&&(d.isLoggedIn=!0,d.isAdmin="false"!=localStorage.isAdmin,d.email=localStorage.email,d.token=localStorage.token);var b=Object(r.b)({name:"login",initialState:d,reducers:{login:function(e,t){e.isLoggedIn=!0,e.isAdmin=t.payload.isAdmin,e.email=t.payload.email,e.token=t.payload.token,localStorage.setItem("token",t.payload.token),localStorage.setItem("email",t.payload.email),localStorage.setItem("isAdmin",t.payload.isAdmin)},logout:function(e){e.isLoggedIn=!1,e.token=null,localStorage.removeItem("token"),localStorage.removeItem("email"),localStorage.removeItem("isAdmin")}}}),j=b.actions,m=j.login,u=j.logout,O=b.reducer,h=a(1),x=function(){var e=Object(o.c)((function(e){return e.user})),t=Object(o.b)();return Object(h.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:Object(h.jsxs)("div",{className:"container-fluid",children:[Object(h.jsx)(i.c,{className:"navbar-brand",to:"/",children:"Navbar"}),Object(h.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarNav",children:[Object(h.jsxs)("ul",{className:"navbar-nav",children:[Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.c,{className:"nav-link",to:"/",children:"Home"})}),e.isLoggedIn&&Object(h.jsx)("li",{className:"nav-item ml-auto",children:Object(h.jsx)(i.c,{className:"nav-link",to:"/posts",children:"Posts"})})]}),!e.isLoggedIn&&Object(h.jsx)("ul",{className:"navbar-nav ms-auto",children:Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsx)(i.c,{className:"nav-link",to:"/login",children:"Login"})})}),e.isLoggedIn&&Object(h.jsx)("ul",{className:"navbar-nav ms-auto",children:Object(h.jsx)("li",{className:"nav-item",children:Object(h.jsxs)("button",{className:"btn btn-success",onClick:function(){return t(u())},children:["LogOut - ",e.email]})})})]})]})})},p=a(2),g=function(){return Object(h.jsx)("h3",{className:"text-center py-5",children:"Welcome Page"})},f=(a(47),a(29)),v=a.n(f),N=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={};e&&(t.Authorization="Bearer ".concat(localStorage.getItem("token")));var a=v.a.create({baseURL:"https://jwt.vnadiradze.ge",headers:t});return a},y=function(){var e=Object(o.b)();return Object(h.jsx)("div",{className:"login-page",children:Object(h.jsxs)("form",{onSubmit:function(t){t.preventDefault();var a,s=new FormData(t.target),n={email:s.get("email"),password:s.get("password")};(a=n,N().post("/api/login",a)).then((function(t){e(m({isAdmin:1===t.data.user.is_admin,token:t.data.token,email:t.data.user.email}))})).catch((function(e){alert("Invalid Data!")}))},children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Email address"}),Object(h.jsx)("input",{type:"email",required:!0,className:"form-control",name:"email",defaultValue:"admin@gmail.com"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Password"}),Object(h.jsx)("input",{type:"password",required:!0,className:"form-control",name:"password",defaultValue:"admin123"})]}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})})},A=a(14),I=function(){return N(!0).get("api/posts")},S=(a(66),function(){var e=Object(o.c)((function(e){return e.user})),t=Object(s.useState)([]),a=Object(A.a)(t,2),n=a[0],c=a[1];Object(s.useEffect)((function(){I().then((function(e){var t=e.data;c(t)}))}),[]);var l=function(t){var a;e.isAdmin&&(a=t,N(!0).delete("api/posts/delete/".concat(a))).then((function(e){I().then((function(e){var t=e.data;c(t)}))}))};return Object(h.jsxs)("div",{className:"posts",children:[Object(h.jsx)("h3",{className:"text-center mb-5",children:"All Posts"}),e.isLoggedIn&&e.isAdmin?Object(h.jsx)(i.b,{to:"/newpost",className:"btn btn-success",children:"Add New Post"}):null,n.length>0&&Object(h.jsx)("ul",{className:"posts",children:n.map((function(t){return Object(h.jsxs)("li",{children:[Object(h.jsx)("h4",{children:t.title}),Object(h.jsx)("p",{children:t.body}),e.isAdmin&&Object(h.jsx)(i.b,{to:"/editpost/".concat(t.id),className:"btn btn-primary",children:"Edit"}),e.isAdmin&&Object(h.jsx)("button",{className:"btn btn-danger ms-2",onClick:function(){l(t.id)},children:"Delete"})]},t.id)}))})]})}),k=function(){var e=Object(p.h)().id,t=Object(p.g)(),a=Object(s.useState)(),n=Object(A.a)(a,2),c=n[0],l=n[1];Object(s.useEffect)((function(){(function(e){return N(!0).get("api/posts/".concat(e))})(e).then((function(e){l(e.data)}))}),[e]);return Object(h.jsx)("div",{className:"editPost",children:void 0!==c&&Object(h.jsxs)("form",{onSubmit:function(a){a.preventDefault();var s=new FormData(a.target),n={id:+e,title:s.get("title"),body:s.get("body")};(function(e,t){return N(!0).put("api/posts/update/".concat(e),t)})(+e,n).then((function(){alert("Updated Successfully!"),t.replace("/posts")})).catch((function(e){console.log(e)}))},children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Title"}),Object(h.jsx)("input",{type:"text",required:!0,className:"form-control",name:"title",defaultValue:c.title})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Description"}),Object(h.jsx)("textarea",{rows:"5",required:!0,className:"form-control",name:"body",defaultValue:c.body})]}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update"}),Object(h.jsx)(i.b,{to:"/posts",className:"btn btn-success ms-2",children:"Cancel"})]})})},w=function(){var e=Object(p.g)();return Object(h.jsx)("div",{className:"editPost",children:Object(h.jsxs)("form",{onSubmit:function(t){t.preventDefault();var a=new FormData(t.target);(function(e){return N(!0).post("api/posts/create",e)})({title:a.get("title"),body:a.get("body")}).then((function(){alert("Added Successfully!"),e.replace("/posts")})).catch((function(e){console.log(e)}))},children:[Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Title"}),Object(h.jsx)("input",{type:"text",required:!0,className:"form-control",name:"title"})]}),Object(h.jsxs)("div",{className:"mb-3",children:[Object(h.jsx)("label",{className:"form-label",children:"Description"}),Object(h.jsx)("textarea",{rows:"5",required:!0,className:"form-control",name:"body"})]}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Add"}),Object(h.jsx)(i.b,{to:"/posts",className:"btn btn-success ms-2",children:"Cancel"})]})})},L=function(){var e=Object(o.c)((function(e){return e.user}));return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(x,{}),Object(h.jsx)("div",{className:"container py-5",children:Object(h.jsxs)(p.d,{children:[Object(h.jsx)(p.b,{path:"/",exact:!0,children:Object(h.jsx)(g,{})}),Object(h.jsx)(p.b,{path:"/login",children:e.isLoggedIn?Object(h.jsx)(p.a,{to:"/"}):Object(h.jsx)(y,{})}),Object(h.jsx)(p.b,{path:"/posts",children:e.isLoggedIn?Object(h.jsx)(S,{}):Object(h.jsx)(p.a,{to:"/"})}),Object(h.jsx)(p.b,{path:"/editpost/:id",children:e.isLoggedIn&&e.isAdmin?Object(h.jsx)(k,{}):Object(h.jsx)(p.a,{to:"/"})}),Object(h.jsx)(p.b,{path:"/newpost",children:e.isLoggedIn&&e.isAdmin?Object(h.jsx)(w,{}):Object(h.jsx)(p.a,{to:"/"})})]})})]})},D=Object(r.a)({reducer:{user:O}});l.a.render(Object(h.jsx)(n.a.StrictMode,{children:Object(h.jsxs)(i.a,{children:[Object(h.jsx)(o.a,{store:D,children:Object(h.jsx)(L,{})}),","]})}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.ed0545d1.chunk.js.map